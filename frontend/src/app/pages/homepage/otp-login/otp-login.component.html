<div
  class="fixed inset-0 z-[100] flex items-end sm:items-center justify-center p-4 bg-black/60 backdrop-blur-sm"
>
  <div
    class="bg-white w-full max-w-md rounded-[2.5rem] p-8 shadow-2xl transition-all transform animate-in slide-in-from-bottom"
  >
    <div class="flex justify-end">
      <button (click)="close.emit()" class="text-gray-400 hover:text-gray-600">
        <fa-icon [icon]="icons.close"></fa-icon>
      </button>
    </div>

    <div *ngIf="step() === 'phone'" class="space-y-6">
      <div class="text-center">
        <h3 class="text-2xl font-black text-gray-900">Enter Phone Number</h3>
        <p class="text-sm text-gray-400 mt-2">
          We'll send a 6-digit code to verify you.
        </p>
      </div>

      <div class="relative">
        <span
          class="absolute left-6 top-1/2 -translate-y-1/2 font-bold text-gray-400"
          >+91</span
        >
        <input
          type="tel"
          [(ngModel)]="phoneNumber"
          placeholder="99999 99999"
          class="w-full pl-16 pr-6 py-4 bg-gray-50 border-none rounded-2xl text-lg font-bold tracking-widest focus:ring-2 focus:ring-orange-500/20"
        />
      </div>

      <button
        (click)="sendOtp()"
        [disabled]="phoneNumber.length < 10 || loading()"
        class="w-full py-4 bg-orange-600 text-white rounded-2xl font-black uppercase tracking-widest hover:bg-orange-700 disabled:bg-gray-200 transition-all flex items-center justify-center gap-3"
      >
        <fa-icon
          *ngIf="loading()"
          [icon]="icons.spinner"
          [animation]="'spin'"
        ></fa-icon>
        <span>{{ loading() ? "Sending..." : "Get OTP" }}</span>
      </button>
    </div>

    <div *ngIf="step() === 'otp'" class="space-y-6">
      <div class="text-center">
        <h3 class="text-2xl font-black text-gray-900">Verify Code</h3>
        <p class="text-sm text-gray-400 mt-2">Sent to +91 {{ phoneNumber }}</p>
      </div>

      <input
        type="text"
        [(ngModel)]="otpValue"
        placeholder="· · · · · ·"
        maxlength="6"
        class="w-full px-6 py-4 bg-gray-50 border-none rounded-2xl text-center text-3xl font-black tracking-[1rem] focus:ring-2 focus:ring-orange-500/20"
      />

      <button
        (click)="verifyOtp()"
        [disabled]="otpValue.length < 6 || loading()"
        class="w-full py-4 bg-gray-900 text-white rounded-2xl font-black uppercase tracking-widest hover:bg-black disabled:bg-gray-200 transition-all flex items-center justify-center gap-3"
      >
        <fa-icon
          *ngIf="loading()"
          [icon]="icons.spinner"
          [animation]="'spin'"
        ></fa-icon>
        <span>Verify & Continue</span>
      </button>

      <button
        (click)="step.set('phone')"
        class="w-full text-xs font-bold text-orange-600 uppercase tracking-widest"
      >
        Change Phone Number
      </button>
    </div>

    <div id="recaptcha-container"></div>
  </div>
</div>
